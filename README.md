# simulator

※FPUを追加しましたが、まだテストしていません

## ISA

RV32IF

## ビルド方法

`make`

## 実行方法

シミュレートしたい命令ファイルを`instr_file`としたときに
ファイルがバイナリの場合`./sim instr_file`

ファイルがテキストの場合`./sim -t instr_file`

命令ファイルは必須です。ただし、メモリに初期値を設定したい場合は下に示すようなオプションで設定可能です。
  
使用ファイルのオプションをつけて実行した後にコマンドを打ってシミュレーションを行えます。  
  
## file option

`-t txt-instruction-file`

`-d data-file`

`-e txt-data-file`

## command

`b [d]` [d]番目の命令にブレークポイントを設定する

`r` 次の命令から設定したブレークポイントまで一気に実行（ブレークポイントが無ければ最後まで）

`re` 次の命令から最後（フェッチした命令語が32bit 0 となるまで）まで一気に実行し、すべてのレジスタの中身を整数で表示

`s` 次の命令を逆アセンブルした結果を命令の二進表現とともに表示し、その命令だけを実行

`sn [d]` ステップ実行を一気に[d]回行う

`x [d]` インデックスが[d]のレジスタの中身をステップ実行の際に常に表示

`f [d]` インデックスが[d]の浮動小数点数レジスタの中身をステップ実行の際に常に表示

`m [type][size] [address]` メモリの[address]番地から[size]分だけを[type]型でステップ実行の際に表示、また、全命令を実行した後にも表示される`i`でint、`u`でunsigned int、`f`でfloat。`b`でbyte、`h`でhalf word、`w`でword。

`q` その時点で終了

## 注意書き

浮動小数点数の計算はCライブラリのものを用いる。

rounding modeは今のところは000すなわちRNEのみを許すようにしてある。
